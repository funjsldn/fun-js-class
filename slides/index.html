<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Functional Programming In Javascript</title>
  
  <link rel="stylesheet" href="reveal/css/reveal.min.css">
  <link rel="stylesheet" href="reveal/lib/css/googlecode.css">

  <link rel="stylesheet" href="slides-theme/style.css">
  <link rel="stylesheet" href="slides-theme/talk-specific.css">
  <link rel="stylesheet" href="diagrams.css">
</head>

<body>

  <div class="reveal">
    <div class="slides">

      <section data-markdown class=front><script type="text/template">
          # Functional Programming

          Grab code: <br> [github.com/funjsldn/fun-js-class](https://github.com/funjsldn/fun-js-class)

          <div class=spaced>

            [@timruffles](http://twitter.com/timruffles)
            [@mattfieldy](http://twitter.com/mattfieldy)
            
          </div>

      </script></section>

      <section data-markdown ><script type="text/template">
          # Hello

          - [github.com/funjsldn/fun-js-class](https://github.com/funjsldn/fun-js-class)
          - Code + slides up above - clone if you've got `git`, or grab the `.zip`.
          - `slides`
          - `exercises`

      </script></section>

      <section data-markdown ><script type="text/template">
          # What is FP?
      </script></section>

<section data-markdown ><script type="text/template">

- Passing functions to functions
- Conciousness of sharing things that change
- Separation of 'do something' and 'transforms data' code

</script></section>

      <section data-markdown ><script type="text/template">
          # Higher-Order Functions

          * What are they?
          * How do they work?
          * Why would we use them?
          * Exercises
          
      </script></section>

      <section data-markdown ><script type="text/template">
          # What are HOFs?

          * Functions that do at least one of the following:
          
            1. Take one or more functions as input
            1. Return a function as their result
          
      </script></section>

      <section>

        <pre><code>
        function forEach(xs, fn) {
          for (var i = 0; i < xs.length; i++) {
            return fn(xs[i]);
          }
        }
        </code></pre>
        
        <pre><code class="javascript">
        function greaterThan(n) {
          return function(m) {
            return m > n;
          }
        }

        var greaterThan10 = greaterThan(10);
              
        greaterThan10(11);
        //=> true
        </code></pre>
        
      </section>

      <section data-markdown ><script type="text/template">
          ### JavaScript has first-class functions

          <pre><code >
              function hello(){
                return "Hello, world!";
              }

              hello();
              //=> "Hello, world!"

              hello;
              //=> "function hello()"

              var ohai = hello;

              ohai();
              //=> "Hello, world!"

              function callThis(f){
                return f();
              }

              callThis(hello);
              //=> "Hello, world!"
              
          </code></pre>
      </script></section>

      <section data-markdown ><script type="text/template">
          # Why would you use them?

          > There are two ways of constructing a software design:
          > One way is to make it so simple that there are obviously no
          > deficiencies and the other way is to make it so complicated
          > that there are no obvious deficiencies. 
          >
          > -- C.A.R Hoare, 1980 ACM Turing Award Lecture
      </script></section>

      <section data-markdown ><script type="text/template">
          * Which is more likely to contain a bug?
          
          <pre><code>
              // Self-contained, six-lines long
              var total = 0, count = 1;
              while (count <= 10) {
                total = count;
                count += 1;
              }
              console.log(total);                
          </code></pre>
          <pre><code>
              // Relies on two external functions, one line long
              console.log(sum(range(1, 10)));
              
          </code></pre>

          * Program needed to write the second longer than the first, but more likely to be correct
          * By building a language in which to express problem, then solving in terms of the problem's domain, solution gains clarity
            * i.e. summing a range of numbers isn't about loops and counters, but ranges and sums
      </script></section>

      <section>
        <ul>
          <li>Powerful level of abstraction</li>
          <ul>
            <li>Specifically, abstraction over <em>actions</em> not just values</li>
          </ul>
        </ul>

        <pre><code >
          function unless(test, then){
            if (!test) then();
          }

          function repeat(times, body){
            for (var i = 0; i < times; i++) body(i);
          }

          repeat(3, function(n){
            unless(n % 2, function(){
              console.log(n, "is even");
            });
          });
        </code></pre>
      </section>

      <section data-markdown ><script type="text/template">
          # Familiar Examples

          Canonical examples:
          
          * map
          * filter
          * reduce
      </script></section>
      
      <section data-markdown><script type="text/template">
          # map

          Takes an array of items and applies a function to each item in that array, then returns a *new* array whose items are the result.

              function map(xs, fn){
                var arr = [];
                for (var i = 0; i < xs.length; i++) {
                  arr.push(fn(xs[i]));    
                }
                return arr;
              }

              map(["an", "array", "of", "strings"], function(word){
                return word.toUppercase();
              });
              //=> ["AN", "ARRAY", "OF", "STRINGS"]
      </script></section>

      <section data-markdown><script type="text/template">
          # filter

          Takes an array of items and applies a predicate (a function that returns either true or false) to each of them. Returns a list of those items that satisfy the predicate.

              function filter(xs, pred){
                var filtered = [];
                for (var i = 0; i < xs.length; i++) {
                  var item = xs[i];
                  if (pred(item)) filtered.push(item);
                }
                return filtered;
              }

              filter(["one", 2, 3, "four", "five", 6], function(item){
                return _.isNumber(item);
              });
              //=> [2, 3, 6] 
          
      </script></section>

      <section data-markdown><script type="text/template">
          # reduce

          Applies a function against an accumulated value and each value of an array, from left-to-right, and reduces down to a single value.

              function reduce(xs, fn, initial){
                var result = initial;
                for (var i = 0; i < xs.length; i++) {
                  result = fn(result, xs[i]);
                }
                return result;
              }

              function add(a, b){ return a + b; }

              reduce([1,2,3,4,5], add, 0);
              //=> 15

      </script></section>

      <section data-markdown><script type="text/template">

      // Or, a slightly less-contrived example

      function flatten(a, b){ return a.concat(b); }

      reduce([[0, 1], [2, 3], [4, 5]], flatten, []);
      //=> [0, 1, 2, 3, 4, 5]
              
      </script></section>

      <section>
        <h3>Making Our Own</h3>

        <pre><code >
        function getText(el){ return el.innerText }

        var links = document.getElementsByClassName('link');

        map(links, getText);
        //=> ["Home", "About", "Blog", "Contact"]
        </code></pre>
                
        <p>Instead of passing a function into `map`, could write a HOF that instead takes a function and turns into a mapping:</p>

      <pre><code >
      function splat(fn){
        return function(xs){
          return Array.prototype.map.call(list, fn);
        }
      }

      // Create a new mapping function from `pluck`:
      var mapGetText = splat(getText);

      mapGetText(links);
      //=> ["Home", "About", "Blog", "Contact"]
      </code></pre>
      </section>

      <section>
        <p>If we didn't use `splat`, we'd have to write something like this out every time we wanted to construct a function that maps an array to a result:</p>

        <pre><code >
          function mapGetText(xs){
            return xs.map(function(x){
              return x.innerText;
            });
          }
        </pre></code>
      </section>

      <section>
        <h3>What about objects?</h3>
        <br/>
        <p><code>get</code> - takes the name of a property and returns a function 
    that gets that property from an object:</p>
        <pre><code >
            function get(prop){
              return function(object){
                return object[prop];
              };
            }

            var user = {
              'name': 'John',
              'age': 32,
              'location': 'London'
            };

            get('location')(user);
            //=> 'London'
        </code></pre>
      </section>

      <section>
        <pre><code >
        var users = [
          { 'name': 'John',
             'age': 32,
             'location': 'London' },
          { 'name': 'Wendy',
            'age': 19,
            'location': 'Amsterdam' },
          { 'name': 'Sheila',
            'age': 41,
            'location': 'New York' }
        ];
        </code></pre>
        <p>Now we can make our earlier <code>splat</code> function work for us:</p>
        <pre><code >
        var firstNames = splat(get('name'))(users);
        //=> ["John", "Wendy", "Sheila"]

        // Which is nicer that writing:
        var firstNames = splat(function(user){
          return user.name
        })(users);
        </code></pre>
      </section>
      
      <section>
        <p>Such a common pattern that we can take things up another level:</p>
        <pre><code >
        function pluck(prop){
          return splat(get(prop));
        }

        pluck('name')(users);
        //=> ["John", "Wendy", "Sheila"]
        </code></pre>
        <br/>
        <p>Libraries like Lo-Dash implement this in a slightly different format:</p>
        <pre><code >
        _.pluck(users, 'name');
        //=> ["John", "Wendy", "Sheila"]
        </code></pre>
      </section>

      <section data-markdown>
        # Your turn

        ## Implementing Underscore
      </section>

      <section data-markdown>
        # Combinators
        
        * What are they?
        * How do they work?
        * Why would we use them?
      </section>

      <section data-markdown>
        ### Specifically:
        
        > A combinator is a higher-order function that uses only function application
        and previously-defined combinators to define a result from its arguments.

        ### In other words:

        > Combinators are pure functions that act on other functions to produce functions.
      </section>
      
      <section>
        <h2>Interlude - A Brief History</h2>

        <h2>1930s</h2>
        <br/>
        <div class="fragment">
          <h3 class="center">Alonzo Church</h3>
          <br/>
          <img src="./img/church.jpg" height="350">
        </div>
        <aside class="notes">
          * American mathematician and logician
          * Major contributions to mathematical logic and foundations of CS
        </aside>
      </section>
      
      <section>
        <br/>
        <br/>
        <br/>
        <br/>
        <img src="./img/lambda.png">
        <aside class="notes">
          * Foundations of computer science
          * Formal system in math logic and CS for expressing computation
          * Probably most famous for serving as basis of Lisp, invented by John
          McCarthy in 1958
        </aside>
      </section>

      <section>
        <h2>Lambda Calculus</h2>
        <br/>
        <ul>
          <li>Formal systems in mathmatical logic and computer science for expression computation using only:</li>
          <ul>
            <li>function abstraction</li>
            <li>function application</li>
          </ul>
        </ul>
        <pre><code >
            // Abstraction - (&#955;x.x)
            function(x){ return x };

            // Application - (ƒ x)
            (function(x){ return x })(y);
        </code></pre>
      </section>
        
      <section>
        <pre><code >
          /* Functions that return functions
             :: &#955;x.&#955;y.x + y */
          function(x){
            return function(y){
              return x + y;
            }
          }

          /* Functions that take functions as input
             :: &#955;ƒ.&#955;x.(ƒ x) */
          function(fn){
            return function(x){
              return fn(x);
            }
          }
        </code></pre>
        <br/>
        <h2 class="fragment center">Look familiar?</h2>
        <br/>
        <p class="fragment center">First-class functions & higher-order functions</p>
      </section>

      <section>
        <h2 class="center">By our powers combined</h2>
        <br/>
        <h3 class="center">Haskell Curry</h3>
        <br/>
        <img src="./img/curry.jpg">
        <br/>
        <br/>
        <h3 class="fragment center">Combinatory logic</h3>
        <aside class="notes">
          * American mathematician and logician
          * Variant of the lambda calculus -> combinatory logic
      </section>

      <section>
        <h2>Combinators > abstraction</h2>
        <br/>
        <ul>
          <li>Function abstraction replaced with a set of <em>combinators</em>, primitive
          functions that contain no bound variables:</li>
        </ul>
        <pre><code class="javascript">
            // Function abstraction
            function(x){ return x };
            //=> x

            // "Identity" or I combinator
            var I = function(x){ return x; };
            
            I(ƒ);
            //=> ƒ

            // "Kestrel" or K combinator
            var K = function(x){
              return function(y){
                return x;
              }
            };

            K(5)(10);
            //=> 5
        </code></pre>
      </section>

      <section>
        <blockquote><h2 class="center">If Objects are nouns and Methods are verbs, Combinators are the adverbs of programming.</h2>
          <br/>
          <cite>- JavaScript Allongé, Reg Brathwaite</cite>
        </blockquote>
      </section>

      <section>
        <h2>And now for something useful</h2>
        <br/>
        <pre class="fragment"><code>
          function splat(fn){
            return function(xs){
              return Array.prototype.map.call(list, fn);
            }
          }
        </code></pre>
        <pre class="fragment"><code >
          function get(prop){
            return function(object){
              return object[prop];
            };
          }
        </code></pre>
        <pre class="fragment"><code >
          function pluck(prop){
            return splat(get(prop));
          } 
        </code></pre>
      </section>

      <section>
        <h2>Maybe</h2>
        <br/>
        <ul>
          <li>JavaScript doesn't strongly enforce notion of variables or properties be <em>something</em></li>
          <li>Have to write programs to account for values that may be <em>nothing</em></li>
        </ul>
        <pre><code >
            function isSomething(value){
              return value != null;
            }

            function checkAndRun(value){
              if (isSomething(value){
                // do something
              }
            }
        </code></pre>
        <pre><code >
            var something = isSomething(value) ?
                            justRuns(value) : value;
        </code></pre>
      </section>

      <section>
        <h2>Maybe</h2>
        <br/>
        <pre><code class="language-javascript">
            function maybe(fn){
              return function(){
                var i;

                if (arguments.length === 0) {
                  return;
                } else {
                  for (i = 0; i < arguments.length; ++i) {
                    if (arguments[i] == null)
                      return arguments[i];
                  }
                  return fn.apply(this, arguments)
                }
              }
            }
        </code></pre>
        <pre><code>
            function checkAndRun = maybe(function(val){
              // do something
            }
        </code></pre>
      </section>

      <section>
        <h2>Combining maybe</h2>
        <pre><code>
          function get(prop){
            return function(object){
              return object[prop];
            };
          }
        </code></pre>
        <pre><code class="language-javascript">
          var sparseArray = [
            { name: 'Matt' },
            { name: 'Tim' },
            null,
            { name: 'Andy' }
            // ....
          ];

          sparseArray.map(get('name'));
          //=> TypeError: Cannot read property 'name' of null

          sparseArray.map(maybe(get('name')));
          //=> ['Matt', 'Tim', null, 'Andy']  
        </code></pre>
      </section>

      <section>
        <h2>D3 Combinators</h2>
      </section>

      <section>
        <h2>Combinators in Underscore</h2>
      </section>

      <section data-markdown ><script type="text/template">
          # Any other questions?

          ### [@timruffles](http://twitter.com/timruffles)
          ### [@mattfieldy](http://twitter.com/mattfieldy)
      </script></section>


</div>
</div>

<script src="js/d3.js"></script>
<script src="js/diagrams.js"></script>

<!-- reveal -->
<script src="reveal/lib/js/head.min.js"></script>
<script src="reveal/js/reveal.min.js"></script>
<script>
  Reveal.initialize({

    // Display controls in the bottom right corner
    controls: false,

    // Display a presentation progress bar
    progress: true,

    // Push each slide change to the browser history
    history: true,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    center: false,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Apply a 3D roll to links on hover
    rollingLinks: false,

    // Transition style
    transition: 'linear', // default/cube/page/concave/zoom/linear/fade/none

    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interreveal/pret Markdown in <section> elements
    { src: 'reveal/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'reveal/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntareveal/x highlight for <code> elements
          { src: 'reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

          // Zoom reveal/in and out with Alt+click
          { src: 'reveal/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

          // Speakreveal/er notes
          { src: 'reveal/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

          // Remotreveal/e control your reveal.js presentation using a touch device
          // { src: 'reveal/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
          ]

          });
    </script>
</body>

